# Squid configuration for SSRF protection
# Allow HTTP and HTTPS traffic
http_port 3128

# Access control lists
acl localnet src 10.0.0.0/8
acl localnet src 172.16.0.0/12
acl localnet src 192.168.0.0/16
acl localnet src fc00::/7
acl localnet src fe80::/10

# Safe ports
acl SSL_ports port 443
acl Safe_ports port 80
acl Safe_ports port 443
acl CONNECT method CONNECT

# Deny requests to internal networks (SSRF protection)
acl internal_networks dst 10.0.0.0/8
acl internal_networks dst 172.16.0.0/12
acl internal_networks dst 192.168.0.0/16
acl internal_networks dst 127.0.0.0/8
acl internal_networks dst 169.254.0.0/16
acl internal_networks dst ::1/128
acl internal_networks dst fc00::/7
acl internal_networks dst fe80::/10

# Deny access to internal networks
http_access deny internal_networks

# Allow HTTPS connect to safe ports
http_access allow CONNECT SSL_ports

# Deny CONNECT to other ports
http_access deny CONNECT !Safe_ports

# Allow access from local network
http_access allow localnet

# Allow access from localhost
http_access allow localhost

# Deny all other access
http_access deny all

# Disable caching
cache deny all

# Hide proxy identity
forwarded_for off
via off

# Disable logging for privacy
access_log none
cache_log /dev/null
cache_store_log /dev/null 